@startuml Sequence

skinparam maxMessageSize 250
hide footbox

mainframe **Interaksi** Buat Portofolio

actor Investor as I
boundary "Tab Portofolio" as TP
boundary "Modal Buat Portofolio" as MBP
control "Portofolio Control" as PC
entity "Portofolio" as P

ref over I, P : Lihat Daftar Portofolio

' User opens the portofolio modal
I -> TP : createPortofolio
activate TP

TP -> MBP : showModal
activate MBP

'User submits form
I -> MBP : submit(name, currency, cashBalance)
activate MBP

MBP -> PC : createPortofolio(name, currency, cashBalance)
activate PC

'Validation step
PC -> PC : validate
activate PC
deactivate PC

alt invalid input
  PC -->> MBP : error
  MBP -->> MBP : showError
else valid input
  'Create and save the Portofolio entity
  PC -> P ** : create(userId, name, currency, cashBalance)
  activate P
  P -->> PC : Portofolio
  deactivate P
end

  PC -> P : save
  activate P
  P -> P : update fields (id)
  activate P
  deactivate P
  P -->> PC : return
  deactivate P

  PC -->> MBP : Portofolio
  deactivate PC

  'Update UI and close modal
  MBP -> TP : updatePortofolioList
  activate TP

  TP -->> MBP : return
  deactivate TP

  MBP -->> MBP : hideModal
  activate MBP
  deactivate MBP
  deactivate MBP
  deactivate MBP

@enduml
