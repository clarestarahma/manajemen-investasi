@startuml Sequence

skinparam maxMessageSize 250
hide footbox

mainframe **Interaksi** Edit Kepemilikan Aset

actor Investor as I
boundary "Halaman Detail Portofolio" as HDP
boundary "Modal Edit Aset" as MEA
control "Portofolio Control" as PC
entity "PortofolioAsset" as PA

ref over I, PA : Lihat Detail Portofolio

' User opens the asset modal
I -> HDP : editAsset(assetId)
activate HDP

HDP -> MEA : showModal(alertId)
activate MEA

'User submits form
I -> MEA : submit(portofolioId, assetId, quantity)
activate MEA

MEA -> PC : editPortofolioAsset(portofolioId, assetId, quantity)
activate PC

'Validation step
PC -> PC : validate
activate PC
deactivate PC

alt invalid input
  PC -->> MEA : error
  MEA -->> MEA : showError
else valid input
  PC -> PA ** : get(portofolioId, assetId)
  activate PA

  PA -->> PC : PortofolioAsset
  deactivate PA
end

  PC -> PA : update field (quantity)
  activate PA
  PA -->> PC : done
  deactivate PA

  PC -> PA : save
  activate PA
  PA -->> PC : return
  deactivate PA

  PC -->> MEA : PortofolioAsset
  deactivate PC

  'Update UI and close modal
  MEA -> HDP : updatePortofolioAssetList
  activate HDP

  HDP -->> MEA : return
  deactivate HDP

  MEA -->> MEA : hideModal
  activate MEA
  deactivate MEA
  deactivate MEA
  deactivate MEA

@enduml
