@startuml Sequence

skinparam maxMessageSize 250
hide footbox

mainframe **Interaksi** Buat Peringatan Harga

actor Investor as I
boundary "Tab Peringatan Harga" as TPH
boundary "Modal Buat Peringatan Harga" as MBPH
control "Price Alert Control" as PAC
entity "PriceAlert" as PA

ref over I, PA : Lihat Daftar Peringatan Harga

' User opens the price alert modal
I -> TPH : createPriceAlert
activate TPH

TPH -> MBPH : showModal
activate MBPH

'User submits form
I -> MBPH : submit(asset, currency, priceTarget)
activate MBPH

MBPH -> PAC : createPriceAlert(asset, currency, priceTarget)
activate PAC

'Validation step
PAC -> PAC : validate
activate PAC
deactivate PAC

alt invalid input
  PAC -->> MBPH : error
  MBPH -->> MBPH : showError
else valid input
  'Create and save the PriceAlert entity
  PAC -> PA ** : create(userId, asset, currency, priceTarget)
  activate PA
  PA -->> PAC : PriceAlert
  deactivate PA
end

  PAC -> PA : save
  activate PA
  PA -> PA : update fields (id)
  activate PA
  deactivate PA
  PA -->> PAC : return
  deactivate PA

  PAC -->> MBPH : PriceAlert
  deactivate PAC

  'Update UI and close modal
  MBPH -> TPH : updatePriceAlertList
  activate TPH

  TPH -->> MBPH : return
  deactivate TPH

  MBPH -->> MBPH : hideModal
  activate MBPH
  deactivate MBPH
  deactivate MBPH
  deactivate MBPH

@enduml
