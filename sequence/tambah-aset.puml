@startuml Sequence

skinparam maxMessageSize 250
hide footbox

mainframe **Interaksi** Tambah Kepemilikan Aset

actor Investor as I
boundary "Halaman Detail Portofolio" as TP
boundary "Modal Tambah Aset" as MBP
control "Portofolio Control" as PC
entity "PortofolioAsset" as P

ref over I, P : Lihat Daftar Portofolio

I -> TP : addAsset
activate TP

TP -> MBP : showModal
activate MBP

'User submits form
I -> MBP : submit(assetId, quantity)
activate MBP

MBP -> PC : addAsset(portofolioId, assetId, quantity)
activate PC

'Validation step
PC -> PC : validate
activate PC
deactivate PC

alt invalid input
  PC -->> MBP : error
  MBP -->> MBP : showError
else valid input
  'Create and save the Portofolio entity
  PC -> P ** : create(portofolioId, assetId, quantity)
  activate P
  P -->> PC : PortofolioAsset
  deactivate P
end

  PC -> P : save
  activate P
  P -> P : update fields (id)
  activate P
  deactivate P
  P -->> PC : return
  deactivate P

  PC -->> MBP : Portofolio
  deactivate PC

  'Update UI and close modal
  MBP -> TP : updatePortofolioList
  activate TP

  TP -->> MBP : return
  deactivate TP

  MBP -->> MBP : hideModal
  activate MBP
  deactivate MBP
  deactivate MBP
  deactivate MBP

@enduml
